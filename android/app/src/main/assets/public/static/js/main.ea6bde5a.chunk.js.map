{"version":3,"sources":["todo/Item.tsx","core/useNetwork.tsx","core/index.tsx","todo/itemApi.tsx","auth/authApi.tsx","auth/AuthProvider.tsx","auth/PrivateRoute.tsx","auth/Login.tsx","todo/ItemProvider.tsx","core/useAppState.tsx","todo/ItemList.tsx","todo/ItemEdit.tsx","todo/ItemSearch.tsx","App.tsx","serviceWorker.ts","index.tsx","../node_modules/@ionic/core/dist/esm-es5 lazy /^/.*/.entry/.js$/ include: /.entry/.js$/ exclude: /.system/.entry/.js$/ groupOptions: {} namespace object","../node_modules/ionicons/dist/esm-es5 lazy /^/.*/.entry/.js$/ include: /.entry/.js$/ exclude: /.system/.entry/.js$/ groupOptions: {} namespace object"],"names":["Item","_id","title","year","type","onEdit","onClick","style","width","icon","videocam","Network","Plugins","initialState","connected","connectionType","useNetwork","useState","networkStatus","setNetworkStatus","useEffect","handler","addListener","handleNetworkStatusChange","getStatus","then","canceled","remove","status","console","log","baseUrl","getLogger","tag","args","withLogs","promise","fnName","res","Promise","resolve","data","catch","err","reject","config","headers","authConfig","token","Authorization","itemUrl","getItems","axios","get","createItem","item","post","updateItem","put","deleteItemApi","delete","authUrl","login","username","password","Storage","isAuthenticated","isAuthenticating","authenticationError","pendingAuthentication","AuthContext","React","createContext","AuthProvider","children","state","setState","useCallback","logout","a","key","authenticate","tokenStorage","value","loginApi","set","Provider","PrivateRoute","Component","component","rest","useContext","render","props","to","pathname","Login","history","placeholder","onIonChange","e","detail","isOpen","message","fetching","saving","deleting","reducer","payload","fetchingError","items","error","savingError","index","findIndex","it","splice","JSON","stringify","deletingError","unsavedItems","ItemContext","ItemProvider","useReducer","dispatch","ret","parse","fetchItems","trim","closeWebSocket","onMessage","ws","WebSocket","onopen","send","onclose","onerror","onmessage","messageEvent","close","newWebSocket","saveItem","deleteItem","savedItem","App","isActive","BackgroundTask","ItemList","appState","setAppState","handleAppStateChange","getState","useAppState","length","disableInfiniteScroll","setDisableInfiniteScroll","position","setPosition","itemsShow","setItemsShow","wait","setTimeout","$event","slice","target","complete","asyncTask","forEach","taskId","beforeExit","finish","wifi","color","slot","map","cloudUploadOutline","id","push","movie","i","threshold","disabled","onIonInfinite","searchNext","loadingSpinner","loadingText","vertical","horizontal","add","ItemEdit","match","setTitle","setYear","setType","setItem","routeId","params","find","editedItem","goBack","filter","setFilter","criteria","searchTitle","setSearchTitle","toLowerCase","includes","option","debounce","path","exact","ItemSearch","tab","href","home","search","Boolean","window","location","hostname","ReactDOM","document","getElementById","navigator","serviceWorker","ready","registration","unregister","webpackAsyncContext","req","__webpack_require__","o","Error","code","ids","keys","Object","module","exports"],"mappings":"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","file":"static/js/main.ea6bde5a.chunk.js","sourcesContent":["import React from 'react';\nimport { IonItem, IonLabel, IonCard, IonCardHeader, IonCardTitle, IonCardSubtitle, IonCardContent, IonIcon} from '@ionic/react';\nimport { ItemProps } from './ItemProps';\nimport { videocam } from 'ionicons/icons';\n\ninterface ItemPropsExt extends ItemProps {\n  onEdit: (_id?: string) => void;\n}\n\nconst Item: React.FC<ItemPropsExt> = ({ _id, title, year, type, onEdit }) => {\n  return (\n    <IonItem onClick={() => onEdit(_id)}>\n      \n      <IonCard style={{width:\"100%\"}}>\n          <IonCardHeader>\n            <IonCardSubtitle>Movie    <IonIcon icon={videocam} /></IonCardSubtitle>\n            <IonCardTitle><strong>Titlu:</strong> <em>{title}</em></IonCardTitle>\n          </IonCardHeader>\n          <IonCardContent>\n            <strong> An: </strong> <em>{year}</em> \n            <strong> Gen: </strong> <em>{type}</em>\n          </IonCardContent>\n        </IonCard>\n    </IonItem>\n  );\n};\n\nexport default Item;\n","import { useEffect, useState } from 'react';\r\nimport { NetworkStatus, Plugins } from '@capacitor/core';\r\n\r\nconst { Network } = Plugins;\r\n\r\nconst initialState = {\r\n  connected: false,\r\n  connectionType: 'unknown',\r\n}\r\n\r\nconst useNetwork = () => {\r\n  const [networkStatus, setNetworkStatus] = useState(initialState)\r\n  useEffect(() => {\r\n    const handler = Network.addListener('networkStatusChange', handleNetworkStatusChange);\r\n    Network.getStatus().then(handleNetworkStatusChange);\r\n    let canceled = false;\r\n    return () => {\r\n      canceled = true;\r\n      handler.remove();\r\n    }\r\n\r\n    function handleNetworkStatusChange(status: NetworkStatus) {\r\n      console.log('useNetwork - status change', status);\r\n      if (!canceled) {\r\n        setNetworkStatus(status);\r\n      }\r\n    }\r\n  }, [])\r\n  return { networkStatus };\r\n};\r\n\r\nexport default useNetwork;","export {default as  useNetwork } from './useNetwork';\r\n//export const baseUrl = 'localhost:3000';\r\nexport const baseUrl = '192.168.0.100:3000';\r\n\r\n\r\nexport const getLogger: (tag: string) => (...args: any) => void =\r\n    tag => (...args) => console.log(tag, ...args);\r\n\r\nconst log = getLogger('api');\r\n\r\nexport interface ResponseProps<T> {\r\n  data: T;\r\n}\r\n\r\nexport function withLogs<T>(promise: Promise<ResponseProps<T>>, fnName: string): Promise<T> {\r\n  log(`${fnName} - started`);\r\n  return promise\r\n    .then(res => {\r\n      log(`${fnName} - succeeded`);\r\n      return Promise.resolve(res.data);\r\n    })\r\n    .catch(err => {\r\n      log(`${fnName} - failed`);\r\n      return Promise.reject(err);\r\n    });\r\n}\r\n\r\nexport const config = {\r\n  headers: {\r\n    'Content-Type': 'application/json'\r\n  }\r\n};\r\n\r\nexport const authConfig = (token?: string) => ({\r\n  headers: {\r\n    'Content-Type': 'application/json',\r\n    Authorization: `Bearer ${token}`,\r\n  }\r\n});","import axios from 'axios';\nimport { authConfig, baseUrl, getLogger, withLogs } from '../core';\nimport { ItemProps } from './ItemProps';\n\nconst itemUrl = `http://${baseUrl}/api/item`;\n\nexport const getItems: (token: string) => Promise<ItemProps[]> = token => {\n  return withLogs(axios.get(itemUrl, authConfig(token)), 'getItems');\n}\n\nexport const createItem: (token: string, item: ItemProps) => Promise<ItemProps[]> = (token, item) => {\n  return withLogs(axios.post(itemUrl, item, authConfig(token)), 'createItem');\n}\n\nexport const updateItem: (token: string, item: ItemProps) => Promise<ItemProps[]> = (token, item) => {\n  return withLogs(axios.put(`${itemUrl}/${item._id}`, item, authConfig(token)), 'updateItem');\n}\n\nexport const deleteItemApi: (token: string, item: ItemProps) => Promise<ItemProps[]> = (token, item) => {\n  return withLogs(axios.delete(`${itemUrl}/${item._id}`, authConfig(token)), 'deleteItem');\n}\n\ninterface MessageData {\n  type: string;\n  payload: ItemProps;\n}\n\nconst log = getLogger('ws');\n\nexport const newWebSocket = (token: string, onMessage: (data: MessageData) => void) => {\n  const ws = new WebSocket(`ws://${baseUrl}`);\n  ws.onopen = () => {\n    log('web socket onopen');\n    ws.send(JSON.stringify({ type: 'authorization', payload: { token } }));\n  };\n  ws.onclose = () => {\n    log('web socket onclose');\n  };\n  ws.onerror = error => {\n    log('web socket onerror', error);\n  };\n  ws.onmessage = messageEvent => {\n    log('web socket onmessage');\n    onMessage(JSON.parse(messageEvent.data));\n  };\n  return () => {\n    ws.close();\n  }\n}","import axios from 'axios';\nimport { baseUrl, config, withLogs } from '../core';\n\nconst authUrl = `http://${baseUrl}/api/auth/login`;\n\nexport interface AuthProps {\n  token: string;\n}\n\nexport const login: (username?: string, password?: string) => Promise<AuthProps> = (username, password) => {\n  console.log(\"AJUNGE AICI\");\n  return withLogs(axios.post(authUrl, { username, password }, config), 'login');\n}\n","import React, { useCallback, useEffect, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { getLogger } from '../core';\nimport { login as loginApi } from './authApi';\nimport {Plugins} from \"@capacitor/core\";\n\nconst {Storage}=Plugins;\n\nconst log = getLogger('AuthProvider');\n\ntype LoginFn = (username?: string, password?: string) => void;\ntype LogoutFn=()=>void;\n\nexport interface AuthState {\n  authenticationError: Error | null;\n  isAuthenticated: boolean;\n  isAuthenticating: boolean;\n  login?: LoginFn;\n  logout?: LogoutFn;\n  pendingAuthentication?: boolean;\n  username?: string;\n  password?: string;\n  token: string;\n}\n\nconst initialState: AuthState = {\n  isAuthenticated: false,\n  isAuthenticating: false,\n  authenticationError: null,\n  pendingAuthentication: false,\n  token: '',\n};\n\nexport const AuthContext = React.createContext<AuthState>(initialState);\n\ninterface AuthProviderProps {\n  children: PropTypes.ReactNodeLike,\n}\n\nexport const AuthProvider: React.FC<AuthProviderProps> = ({ children }) => {\n  const [state, setState] = useState<AuthState>(initialState);\n  const { isAuthenticated, isAuthenticating, authenticationError, pendingAuthentication, token } = state;\n  const login = useCallback<LoginFn>(loginCallback, []);\n  const logout = useCallback<LogoutFn>(logoutCallback, []);\n  useEffect(authenticationEffect, [pendingAuthentication]);\n  const value = { isAuthenticated, login, isAuthenticating, authenticationError, token, logout };\n  log('render');\n  return (\n    <AuthContext.Provider value={value}>\n      {children}\n    </AuthContext.Provider>\n  );\n\n  function loginCallback(username?: string, password?: string): void {\n    log('login');\n    setState({\n      ...state,\n      pendingAuthentication: true,\n      username,\n      password\n    });\n  }\n\n  function logoutCallback(): void {\n    log('logout');\n    setState({\n      ...state,\n      isAuthenticated:false,\n      token:\"\"\n    });\n    (async ()=>{\n       await Storage.remove({key:\"user\"})\n    })()\n  }\n\n  function authenticationEffect() {\n    let canceled = false;\n    authenticate();\n    return () => {\n      canceled = true;\n    }\n\n    async function authenticate() {\n      const tokenStorage=await Storage.get({key:\"user\"})\n      if (tokenStorage.value){\n        setState({\n          ...state,\n          token:tokenStorage.value,\n          pendingAuthentication:false,\n          isAuthenticated:true,\n          isAuthenticating:false\n\n        })\n      }\n      if (!pendingAuthentication) {\n        log('authenticate, !pendingAuthentication, return');\n        return;\n      }\n      try {\n        log('authenticate...');\n        setState({\n          ...state,\n          isAuthenticating: true,\n        });\n        const { username, password } = state;\n        const { token } = await loginApi(username, password);\n      \n        if (canceled) {\n          return;\n        }\n        log('authenticate succeeded');\n        await Storage.set({key:\"user\",value:token});\n        setState({\n          ...state,\n          token,\n          pendingAuthentication: false,\n          isAuthenticated: true,\n          isAuthenticating: false,\n        });\n      } catch (error) {\n        if (canceled) {\n          return;\n        }\n        console.log(\"SE SI INTOARCE\");\n      \n        log('authenticate failed');\n        setState({\n          ...state,\n          authenticationError: error,\n          pendingAuthentication: false,\n          isAuthenticating: false,\n        });\n      }\n    }\n  }\n};\n","import React, { useContext } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { Redirect, Route } from 'react-router-dom';\r\nimport { AuthContext, AuthState } from './AuthProvider';\r\nimport { getLogger } from '../core';\r\n\r\nconst log = getLogger('Login');\r\n\r\nexport interface PrivateRouteProps {\r\n  component: PropTypes.ReactNodeLike;\r\n  path: string;\r\n  exact?: boolean;\r\n}\r\n\r\nexport const PrivateRoute: React.FC<PrivateRouteProps> = ({ component: Component, ...rest }) => {\r\n  const { isAuthenticated } = useContext<AuthState>(AuthContext);\r\n  log('render, isAuthenticated', isAuthenticated);\r\n  return (\r\n    <Route {...rest} render={props => {\r\n      if (isAuthenticated) {\r\n        // @ts-ignore\r\n        return <Component {...props} />;\r\n      }\r\n      return <Redirect to={{ pathname: '/login' }}/>\r\n    }}/>\r\n  );\r\n}\r\n","import React, { useContext, useState } from 'react';\nimport { Redirect } from 'react-router-dom';\nimport { RouteComponentProps } from 'react-router';\nimport { IonButton, IonContent, IonHeader, IonInput, IonLoading, IonPage, IonTitle, IonToolbar, IonItem, IonLabel, IonImg } from '@ionic/react';\nimport { AuthContext } from './AuthProvider';\nimport { getLogger } from '../core';\n\nconst log = getLogger('Login');\n\ninterface LoginState {\n  username?: string;\n  password?: string;\n}\n\nexport const Login: React.FC<RouteComponentProps> = ({ history }) => {\n  const { isAuthenticated, isAuthenticating, login, authenticationError } = useContext(AuthContext);\n  const [state, setState] = useState<LoginState>({});\n  const { username, password } = state;\n  const handleLogin = () => {\n    log('handleLogin...');\n    login?.(username, password);\n  };\n  log('render');\n  if (isAuthenticated) {\n    return <Redirect to={{ pathname: '/' }} />\n  }\n  return (\n    <IonPage>\n      <IonContent>\n            <IonInput\n          placeholder=\"Username\"\n          value={username}\n          onIonChange={e => setState({\n            ...state,\n            username: e.detail.value || ''\n          })}/>\n        <IonInput\n          placeholder=\"Password\"\n          value={password}\n          onIonChange={e => setState({\n            ...state,\n            password: e.detail.value || ''\n          })}/>\n        <IonLoading isOpen={isAuthenticating}/>\n        {authenticationError && (\n          <div>{authenticationError.message || 'Failed to authenticate'}</div>\n        )}\n        <IonButton onClick={handleLogin}>Login</IonButton>\n      </IonContent>\n    </IonPage>\n  );\n};\n","import React, { useCallback, useContext, useEffect, useReducer } from 'react';\nimport PropTypes from 'prop-types';\nimport { getLogger } from '../core';\nimport { ItemProps } from './ItemProps';\nimport { createItem, getItems, newWebSocket, updateItem, deleteItemApi } from './itemApi';\nimport { AuthContext } from '../auth';\nimport { Plugins } from '@capacitor/core'\n\n\nconst {Storage} = Plugins;\nconst log = getLogger('ItemProvider');\n\ntype SaveItemFn = (item: ItemProps) => Promise<any>;\ntype DeleteItemFn = (item: ItemProps) => Promise<any>;\n\nexport interface ItemsState {\n  items?: ItemProps[],\n  unsavedItems?: ItemProps[],\n  fetching: boolean,\n  fetchingError?: Error | null,\n  saving: boolean,\n  savingError?: Error | null,\n  saveItem?: SaveItemFn,\n  deleting: boolean,\n  deletingError?: Error | null,\n  deleteItem?: DeleteItemFn,\n}\n\ninterface ActionProps {\n  type: string,\n  payload?: any,\n}\n\nconst initialState: ItemsState = {\n  fetching: false,\n  saving: false,\n  deleting: false,\n};\n\nconst FETCH_ITEMS_STARTED = 'FETCH_ITEMS_STARTED';\nconst FETCH_ITEMS_SUCCEEDED = 'FETCH_ITEMS_SUCCEEDED';\nconst FETCH_ITEMS_FAILED = 'FETCH_ITEMS_FAILED';\nconst SAVE_ITEM_STARTED = 'SAVE_ITEM_STARTED';\nconst SAVE_ITEM_SUCCEEDED = 'SAVE_ITEM_SUCCEEDED';\nconst SAVE_ITEM_FAILED = 'SAVE_ITEM_FAILED';\nconst DELETE_ITEM_STARTED = 'DELETE_ITEM_STARTED';\nconst DELETE_ITEM_SUCCED = 'DELETE_ITEM_SUCCED';\nconst DELETE_ITEM_FAILED = 'DELETE_ITEM_FAILED';\nconst FETCH_UNSAVED_ITEMS = 'FETCH_UNSAVED_ITEMS';\n\nconst reducer: (state: ItemsState, action: ActionProps) => ItemsState =\n  (state, { type, payload }) => {\n    switch (type) {\n      case FETCH_ITEMS_STARTED:\n        return { ...state, fetching: true, fetchingError: null };\n      case FETCH_ITEMS_SUCCEEDED:\n        return { ...state, items: payload.items, fetching: false };\n      case FETCH_ITEMS_FAILED:\n        return { ...state, fetchingError: payload.error, fetching: false };\n      case SAVE_ITEM_STARTED:\n        return { ...state, savingError: null, saving: true };\n      case SAVE_ITEM_SUCCEEDED:\n        const items = [...(state.items || [])];\n        const item = payload.item;\n        const index = items.findIndex(it => it._id === item._id);\n        if (index === -1) {\n          items.splice(0, 0, item); //adauga elem. la inceputul listei de pe interfata\n        } else {\n          items[index] = item;\n        }\n        (async ()=>{\n          await Storage.set({key: \"items\", value: JSON.stringify(items)});\n        })();\n        return { ...state, items, saving: false };\n      case SAVE_ITEM_FAILED:\n        return { ...state, savingError: payload.error, saving: false };\n      case DELETE_ITEM_STARTED:\n          return { ...state, deletingError: null, deleting: true};\n      case DELETE_ITEM_SUCCED:{\n        const items = [ ...(state.items || [])];\n        const item = payload.item;\n        const index = items.findIndex(it => it._id === item._id);\n        items.splice(index, 1); //sterge elem din lista din interfata\n        (async ()=>{\n          await Storage.set({key: \"items\", value: JSON.stringify(items)});\n        })();\n        return { ...state, items, deleting: false};\n      }\n      case DELETE_ITEM_FAILED:\n        return { ...state, deletingError: payload.error, deleting:false}\n      case FETCH_UNSAVED_ITEMS:\n        return { ...state, unsavedItems: payload.unsavedItems }\n      default:\n        return state;\n    }\n  };\n\nexport const ItemContext = React.createContext<ItemsState>(initialState);\n\ninterface ItemProviderProps {\n  children: PropTypes.ReactNodeLike,\n}\n\nexport const ItemProvider: React.FC<ItemProviderProps> = ({ children }) => {\n  const { token } = useContext(AuthContext);\n  const [state, dispatch] = useReducer(reducer, initialState);\n  const { items, unsavedItems, fetching, fetchingError, saving, savingError, deleting, deletingError } = state;\n  useEffect(getItemsEffect, [token]);\n  useEffect(wsEffect, [token]);\n  const saveItem = useCallback<SaveItemFn>(saveItemCallback, [token]);\n  const deleteItem = useCallback<DeleteItemFn>(deleteItemCallback, [token]);\n  const value = { items, unsavedItems , fetching, fetchingError, saving, savingError, saveItem, deleting, deletingError, deleteItem };\n  log('returns');\n  return (\n    <ItemContext.Provider value={value}>\n      {children}\n    </ItemContext.Provider>\n  );\n\n  function getItemsEffect() {\n    let canceled = false;\n    (async ()=>{\n      const ret = await Storage.get({key: \"unsavedItems\"});\n      const unsavedItems = JSON.parse(ret.value || '[]');\n      if(unsavedItems != []){\n        dispatch({ type: FETCH_UNSAVED_ITEMS, payload: { unsavedItems } });\n      }\n    })();\n    fetchItems();\n    return () => {\n      canceled = true;\n    }\n\n    async function fetchItems() {\n      if (!token?.trim()) {\n        return;\n      }\n      try {\n        log('fetchItems started');\n        dispatch({ type: FETCH_ITEMS_STARTED });\n        const items = await getItems(token);\n        await Storage.set({key:\"items\", value: JSON.stringify(items)});\n        log('fetchItems succeeded');\n        if (!canceled) {\n          dispatch({ type: FETCH_ITEMS_SUCCEEDED, payload: { items } });\n        }\n      } catch (error) {\n        log('fetchItems failed');\n        console.log('eroare este'+error);\n        if(error.message == 'Network Error'){\n          console.log(\"INTRA IN NETWORK ERROR\");\n          //daca nu avem conexiune luam din local storage \n          const ret = await Storage.get({key: \"items\"});\n          const items = JSON.parse(ret.value || '{}');\n          dispatch({ type: FETCH_ITEMS_SUCCEEDED, payload: { items } });\n        }else{\n          dispatch({ type: FETCH_ITEMS_FAILED, payload: { error } });\n        }\n      }\n    }\n  }\n\n  async function saveItemCallback(item: ItemProps) {\n    try {\n      log('saveItem started');\n      dispatch({ type: SAVE_ITEM_STARTED });\n      const savedItem = await (item._id ? updateItem(token, item) : createItem(token, item));\n      log('saveItem succeeded');\n      //daca elementul pentru care a reusit salvarea e pe lista unsavedItems il stergem de pe lista\n      if(unsavedItems){\n        const index = unsavedItems.findIndex(it => it._id === item._id);\n        if(index>=0){\n          unsavedItems.splice(index, 1); //sterge elem din lista din interfata\n        }\n      }\n      dispatch({ type: SAVE_ITEM_SUCCEEDED, payload: { item: savedItem } });\n    } catch (error) {\n      log('saveItem failed');\n      if(error.message == 'Network Error'){\n        //daca nu avem conexiune adaugam in local storage elementele nesalvate\n        unsavedItems?.splice(0, 0, item); //adaugam in elementele nesalvate\n        await Storage.set({key:\"unsavedItems\", value:JSON.stringify(unsavedItems)});\n        dispatch({type: FETCH_UNSAVED_ITEMS, payload: {unsavedItems}});\n      }else{\n        dispatch({ type: SAVE_ITEM_FAILED, payload: { error } });\n      }\n    }\n  }\n\n  async function deleteItemCallback(item: ItemProps) {\n      try{\n        log('deleteItem stared');\n        dispatch({type: DELETE_ITEM_STARTED});\n        const deleteItem = await deleteItemApi(token, item);\n        log('deleteItemSucced');\n        dispatch({type: DELETE_ITEM_SUCCED, payload: {item: item}});\n      }catch(error){\n        log('deleteing failed');\n        dispatch({type: DELETE_ITEM_FAILED, payload: {error}});\n      }\n  }\n\n  function wsEffect() {\n    let canceled = false;\n    log('wsEffect - connecting');\n    let closeWebSocket: () => void;\n    if (token?.trim()) {\n      closeWebSocket = newWebSocket(token, message => {\n        if (canceled) {\n          return;\n        }\n        const { type, payload: item } = message;\n        log(`ws message, item ${type}`);\n        if (type === 'created' || type === 'updated') {\n          //dispatch({ type: SAVE_ITEM_SUCCEEDED, payload: { item } });\n        }\n        if (type === 'deleted') {\n          //dispatch({ type: DELETE_ITEM_SUCCEEDED, payload: { item } });\n         }\n      });\n    }\n    return () => {\n      log('wsEffect - disconnecting');\n      canceled = true;\n      closeWebSocket?.();\n    }\n  }\n};\n","import { useEffect, useState } from 'react';\r\nimport { AppState, Plugins } from '@capacitor/core';\r\n\r\nconst { App } = Plugins;\r\n\r\nconst initialState = {\r\n  isActive: true,\r\n}\r\n\r\nexport const useAppState = () => {\r\n  const [appState, setAppState] = useState(initialState)\r\n  useEffect(() => {\r\n    const handler = App.addListener('appStateChange', handleAppStateChange);\r\n    App.getState().then(handleAppStateChange);\r\n    let canceled = false;\r\n    return () => {\r\n      canceled = true;\r\n      handler.remove();\r\n    }\r\n\r\n    function handleAppStateChange(state: AppState) {\r\n      console.log('useAppState - state change', state);\r\n      if (!canceled) {\r\n        setAppState(state);\r\n      }\r\n    }\r\n  }, [])\r\n  return { appState };\r\n};","import React, { useContext, useEffect, useState } from 'react';\nimport { Redirect, RouteComponentProps } from 'react-router';\nimport {\n  IonContent,\n  IonFab,\n  IonFabButton,\n  IonHeader,\n  IonIcon,\n  IonList, IonLoading,\n  IonPage,\n  IonTitle,\n  IonToolbar,\n  IonButtons,\n  IonButton,\n  IonSelect,\n  IonSelectOption,\n  IonSearchbar,\n  IonInfiniteScroll,\n  IonInfiniteScrollContent,\n  useIonViewWillEnter,\n  IonLabel,\n  IonItemDivider\n} from '@ionic/react';\nimport { add, logOut, wifi, cloudUploadOutline } from 'ionicons/icons';\nimport Item from './Item';\nimport { getLogger } from '../core';\nimport { ItemContext } from './ItemProvider';\nimport {AuthContext} from \"../auth\";\nimport { ItemProps } from './ItemProps';\nimport {useNetwork} from '../core';\nimport { useBackgroundTask } from '../core/useBackgroundTask';\nimport { Plugins } from '@capacitor/core';\nimport { useAppState } from '../core/useAppState';\n\nconst log = getLogger('ItemList');\n\nconst { BackgroundTask } = Plugins;\n\nconst ItemList: React.FC<RouteComponentProps> = ({ history }) => {\n  const { networkStatus } = useNetwork();\n  const { appState } = useAppState();\n  const { items, unsavedItems , fetching, fetchingError, saveItem } = useContext(ItemContext);\n  log('render');\n  console.log(unsavedItems);\n  console.log(\"intra\", items?.length);\n  \n  //logout\n  const { logout } = useContext(AuthContext);\n  const handleLogout = () => {\n    logout?.();\n    return <Redirect to={{ pathname: \"/login\" }} />;\n  };\n\n  //pagination&filter&search\n  const [disableInfiniteScroll, setDisableInfiniteScroll] = useState<boolean>(false); //cat timp se mai poate face scroll pentru paginare\n  const [position, setPosition] = useState(4); //afiseaza cate 4 elem din lista pe ecran\n  const [itemsShow, setItemsShow] = useState<ItemProps[]>([]); //elementele afisate\n\n  function wait(){\n    return new Promise(resolve => {\n      setTimeout(() => {\n        resolve();\n      }, 1000);\n    });\n  }\n\n  async function searchNext($event: CustomEvent<void>) {\n    if (items && position < items.length) {\n      console.log(\"NEXT \",position, items.length);\n      await wait();\n      setItemsShow([...itemsShow, ...items.slice(position, 3 + position)]);\n      setPosition(position + 3);\n    } else {\n      setDisableInfiniteScroll(true);\n    }\n\n    await ($event.target as HTMLIonInfiniteScrollElement).complete();\n  }\n\n  useEffect(() => {\n    if (items?.length) {\n      setItemsShow(items.slice(0, 4));\n    }\n    console.log(\"items \"+position);\n  }, [items]);\n\n  const useBackgroundTask = (asyncTask: () => Promise<void>) => {\n    useEffect(() => {\n      let taskId = BackgroundTask.beforeExit(async () => {\n        console.log('useBackgroundTask - executeTask started');\n        if(!appState.isActive && networkStatus.connected && unsavedItems){\n          // daca suntem din nou online si avem Items neprocesate creeam un nou background task \n          await asyncTask();\n        }\n        console.log('useBackgroundTask - executeTask finished');\n        BackgroundTask.finish({ taskId });\n      });\n    }, [networkStatus, appState])\n    return {};\n  };\n\n  \n  useBackgroundTask(() => new Promise(resolve => {\n    console.log('My Background Task'+ unsavedItems);\n    //apelam api pentru salvare elemente pe server\n    unsavedItems && unsavedItems.forEach(item => {\n      saveItem && saveItem(item);\n    });\n    resolve();\n  }));\n\n  return (\n    <IonPage>\n      <IonHeader>\n        <IonToolbar>\n          <IonTitle>Movies App \n            {\n              networkStatus.connected && <IonIcon icon={wifi} style={{color:\"green\"}} /> \n                                      || <IonIcon icon={wifi} style={{color:\"red\"}} />\n            }\n          </IonTitle>\n          <IonButtons slot=\"end\">\n            <IonButton onClick={handleLogout}>\n              Logout\n            </IonButton>\n          </IonButtons>\n        </IonToolbar>\n      </IonHeader>\n      <IonContent>\n        <IonLoading isOpen={fetching} message=\"Fetching items\" />\n        {unsavedItems && (\n          <><IonItemDivider>\n            <IonLabel>\n                Items are not processed\n            </IonLabel>\n            </IonItemDivider>\n            <IonList>\n              {unsavedItems.map(({ _id, title, year, type }) => \n              <> <IonIcon icon={cloudUploadOutline}/>\n                  <Item key={_id} _id={_id} title={title} year={year} type={type} onEdit={id => history.push(`/item/${id}`)} /></>\n              )}\n            </IonList></>\n        )}\n        <IonItemDivider>\n          <IonLabel>\n            Movies\n          </IonLabel>\n        </IonItemDivider>\n        {itemsShow && itemsShow.map((movie: ItemProps,  i: number) => {\n          return (\n              <Item\n                  key={`${i}`}\n                  _id={movie._id}\n                  title={movie.title}\n                  type={movie.type}\n                  year={movie.year}\n\n                  onEdit={(id) => history.push(`/item/${id}`)}\n               />\n          );\n        })}\n        <IonInfiniteScroll\n            threshold=\"100px\"\n            disabled={disableInfiniteScroll}\n            onIonInfinite={(e: CustomEvent<void>) => searchNext(e)}\n        >\n          <IonInfiniteScrollContent loadingSpinner=\"bubbles\" loadingText=\"Loading more movies...\"/>\n        </IonInfiniteScroll>\n        {fetchingError && (\n          <div>{fetchingError.message || 'Failed to fetch items'}</div>\n        )}\n        <IonFab vertical=\"bottom\" horizontal=\"end\" slot=\"fixed\">\n          <IonFabButton onClick={() => history.push('/item')}>\n            <IonIcon icon={add} />\n          </IonFabButton>\n        </IonFab>\n      </IonContent>\n    </IonPage>\n  );\n};\n\nexport default ItemList;\n","import React, { useContext, useEffect, useState } from 'react';\nimport {\n  IonButton,\n  IonButtons,\n  IonContent,\n  IonHeader,\n  IonInput,\n  IonLabel,\n  IonLoading,\n  IonPage,\n  IonTitle,\n  IonToolbar,\n  IonItemDivider,\n  IonItem\n} from '@ionic/react';\nimport { getLogger } from '../core';\nimport { ItemContext } from './ItemProvider';\nimport { RouteComponentProps } from 'react-router';\nimport { ItemProps } from './ItemProps';\n\nconst log = getLogger('ItemEdit');\n\ninterface ItemEditProps extends RouteComponentProps<{\n  id?: string;\n}> {}\n\nconst ItemEdit: React.FC<ItemEditProps> = ({ history, match }) => {\n  const { items, saving, savingError, saveItem, deleteItem } = useContext(ItemContext);\n  const [title, setTitle] = useState('');\n  const [year, setYear] = useState('');\n  const [type, setType] = useState('');\n  const [item, setItem] = useState<ItemProps>();\n  useEffect(() => {\n    log('useEffect');\n    const routeId = match.params.id || '';\n    const item = items?.find(it => it._id === routeId);\n    setItem(item);\n    if (item) {\n      setTitle(item.title);\n      setType(item.type);\n      setYear(item.year);\n    }\n  }, [match.params.id, items]);\n  const handleSave = () => {\n    const editedItem = item ? { ...item, title, year, type } : { title, year, type };\n    saveItem && saveItem(editedItem).then(() => history.goBack());\n  };\n  const handleDelete = () => {\n    const editedItem = item ? { ...item, title, year, type } : { title, year, type };\n    deleteItem && deleteItem(editedItem).then(() => history.goBack());\n  };\n  log('render');\n  return (\n    <IonPage>\n      <IonHeader>\n        <IonToolbar>\n          <IonTitle>Edit</IonTitle>\n          <IonButtons slot=\"end\">\n            {match.params.id && (    //pune butonul de delete doar daca suntem in edit mode - obiectul deja exista, nu si la adaugare\n            <IonButton onClick={handleDelete} >\n              Delete\n            </IonButton>\n            )} \n            <IonButton onClick={handleSave}>\n              Save\n            </IonButton>\n          </IonButtons>\n        </IonToolbar>\n      </IonHeader>\n      <IonContent>\n        <IonItemDivider>Complete the movie data</IonItemDivider>\n        <IonItem>\n          <IonLabel><strong>Title:</strong></IonLabel>\n          <IonInput value={title} onIonChange={e => setTitle(e.detail.value || '')} />\n        </IonItem>\n        <IonItem>\n          <IonLabel><strong>Year:</strong></IonLabel>\n          <IonInput value={year} onIonChange={e => setYear(e.detail.value || '')} />\n        </IonItem>\n        <IonItem>\n          <IonLabel><strong>Type:</strong></IonLabel>\n          <IonInput value={type} onIonChange={e => setType(e.detail.value || '')} />\n        </IonItem>\n        <IonLoading isOpen={saving} />\n        {savingError && (\n          <div>{savingError.message || 'Failed to save item'}</div>\n        )}\n      </IonContent>\n    </IonPage>\n  );\n};\n\nexport default ItemEdit;\n","import React, { useContext, useEffect, useState } from 'react';\r\nimport { Redirect, RouteComponentProps } from 'react-router';\r\nimport {\r\n  IonContent,\r\n  IonFab,\r\n  IonFabButton,\r\n  IonHeader,\r\n  IonIcon,\r\n  IonList, IonLoading,\r\n  IonPage,\r\n  IonTitle,\r\n  IonToolbar,\r\n  IonButtons,\r\n  IonButton,\r\n  IonSelect,\r\n  IonSelectOption,\r\n  IonSearchbar,\r\n  IonInfiniteScroll,\r\n  IonInfiniteScrollContent\r\n} from '@ionic/react';\r\nimport Item from './Item';\r\nimport { getLogger } from '../core';\r\nimport { ItemContext } from './ItemProvider';\r\nimport {AuthContext} from \"../auth\";\r\nimport { ItemProps } from './ItemProps';\r\n\r\nconst log = getLogger('ItemList');\r\n\r\nconst ItemList: React.FC<RouteComponentProps> = ({ history }) => {\r\n  const { items, fetching, fetchingError } = useContext(ItemContext);\r\n  log('render');\r\n\r\n  //pagination&filter&search\r\n  const [disableInfiniteScroll, setDisableInfiniteScroll] = useState<boolean>(false); //cat timp se mai poate face scroll pentru paginare\r\n  const [filter, setFilter] = useState<string | undefined>(\"all\"); //filtrul ales (genul ales)\r\n  const [criteria, setCriteria] = useState<string[]>([\"all\", \"action\", \"adventure\", \"animation\", \"comedy\", \"crime\", \"drama\", \"historical\", \"horror\", \"political\", \"romance\", \"SF\", \"thriller\" ]); //filtru dupa gen\r\n  const [searchTitle, setSearchTitle] = useState<string>(\"\"); //titlul pentru care se face cautarea\r\n  const [position, setPosition] = useState(4); //afiseaza cate 4 elem din lista pe ecran\r\n  const [itemsShow, setItemsShow] = useState<ItemProps[]>([]); //elementele afisate\r\n\r\n  useEffect(() => {\r\n    if (items?.length) {\r\n      setItemsShow(items.slice(0, 4));\r\n    }\r\n    console.log(\"items \"+position);\r\n  }, [items]);\r\n\r\n  useEffect(() => {\r\n    if (filter!=\"all\" && items) {\r\n      setItemsShow(items.filter((item) => item.type == filter).slice(0, 4));\r\n    }\r\n    else if(items){\r\n      setItemsShow(items.slice(0,4))\r\n    }\r\n    setPosition(4);\r\n    setDisableInfiniteScroll(false);\r\n    console.log(\"filter \"+position);\r\n  }, [filter]);\r\n\r\n  useEffect(() => {\r\n    if (!searchTitle && items) {\r\n        setItemsShow(items.slice(0, 4));\r\n        setPosition(4);\r\n        setDisableInfiniteScroll(false);\r\n    }\r\n    else if (searchTitle && items) {\r\n      setItemsShow(items.filter((item) => item.title.toLowerCase().includes(searchTitle.toLowerCase())));\r\n    }\r\n    console.log(\"search \"+position);\r\n  }, [searchTitle]);\r\n\r\n  function wait(){\r\n    return new Promise(resolve => {\r\n      setTimeout(() => {\r\n        resolve();\r\n      }, 1000);\r\n    });\r\n  }\r\n\r\n  async function searchNext($event: CustomEvent<void>) {\r\n    if (items && position < items.length) {\r\n      console.log(\"NEXT \",position, items.length);\r\n      await wait();\r\n      if(filter==\"all\"){\r\n        setItemsShow([...itemsShow, ...items.slice(position, 3 + position)]);\r\n      }else{\r\n       setItemsShow([...itemsShow, ...items.filter((item) => item.type == filter).slice(position, 3 + position)]);\r\n      }\r\n      setPosition(position + 3);\r\n    } else {\r\n      setDisableInfiniteScroll(true);\r\n    }\r\n\r\n    await ($event.target as HTMLIonInfiniteScrollElement).complete();\r\n  }\r\n\r\n  return (\r\n    <IonPage>\r\n      <IonHeader>\r\n        <IonToolbar>\r\n          <IonTitle>Filter&Search</IonTitle>\r\n        </IonToolbar>\r\n      </IonHeader>\r\n      <IonContent>\r\n        <IonLoading isOpen={fetching} message=\"Fetching items\" />\r\n        <IonSelect\r\n            value={filter}\r\n            placeholder=\"Select type\"\r\n            onIonChange={(e) => setFilter(e.detail.value)}\r\n        >\r\n          {criteria.map((option) => (\r\n              <IonSelectOption key={option} value={option}>\r\n                {option}\r\n              </IonSelectOption>\r\n          ))\r\n          }\r\n          <IonSelectOption key={\"all\"} value={\"all\"}>{\"all\"}</IonSelectOption>\r\n        </IonSelect>\r\n        <IonSearchbar\r\n            value={searchTitle}\r\n            debounce={1000}\r\n            onIonChange={(e) => setSearchTitle(e.detail.value!)}\r\n        />  \r\n        {itemsShow && itemsShow.map((movie: ItemProps) => {\r\n          return (\r\n              <Item\r\n                  key={movie._id}\r\n                  _id={movie._id}\r\n                  title={movie.title}\r\n                  type={movie.type}\r\n                  year={movie.year}\r\n\r\n                  onEdit={(id) => history.push(`/item/${id}`)}\r\n               />\r\n          );\r\n        })}\r\n        <IonInfiniteScroll\r\n            threshold=\"100px\"\r\n            disabled={disableInfiniteScroll}\r\n            onIonInfinite={(e: CustomEvent<void>) => searchNext(e)}\r\n        >\r\n          <IonInfiniteScrollContent loadingSpinner=\"bubbles\" loadingText=\"Loading more movies...\"/>\r\n        </IonInfiniteScroll>\r\n        {fetchingError && (\r\n          <div>{fetchingError.message || 'Failed to fetch items'}</div>\r\n        )}\r\n      </IonContent>\r\n    </IonPage>\r\n  );\r\n};\r\n\r\nexport default ItemList;\r\n","import React from 'react';\nimport { Redirect, Route } from 'react-router-dom';\nimport { IonApp, IonIcon, IonLabel, IonRouterOutlet, IonTabBar, IonTabButton, IonTabs } from '@ionic/react';\nimport { IonReactRouter } from '@ionic/react-router';\nimport { ItemEdit, ItemList, ItemSearch } from './todo';\nimport { home, search } from 'ionicons/icons';\n/* Core CSS required for Ionic components to work properly */\nimport '@ionic/react/css/core.css';\n\n/* Basic CSS for apps built with Ionic */\nimport '@ionic/react/css/normalize.css';\nimport '@ionic/react/css/structure.css';\nimport '@ionic/react/css/typography.css';\n\n/* Optional CSS utils that can be commented out */\nimport '@ionic/react/css/padding.css';\nimport '@ionic/react/css/float-elements.css';\nimport '@ionic/react/css/text-alignment.css';\nimport '@ionic/react/css/text-transformation.css';\nimport '@ionic/react/css/flex-utils.css';\nimport '@ionic/react/css/display.css';\n\n/* Theme variables */\nimport './theme/variables.css';\nimport { ItemProvider } from './todo/ItemProvider';\nimport { AuthProvider, Login, PrivateRoute } from './auth';\n\nconst App: React.FC = () => (\n  <IonApp>\n    <IonReactRouter>\n      <IonTabs>\n      <IonRouterOutlet>\n        <AuthProvider>\n          <Route path=\"/login\" component={Login} exact={true}/>\n          <ItemProvider>\n            <PrivateRoute path=\"/items\" component={ItemList} exact={true}/>\n            <PrivateRoute path=\"/search\" component={ItemSearch} exact={true}/>\n            <PrivateRoute path=\"/item\" component={ItemEdit} exact={true}/>\n            <PrivateRoute path=\"/item/:id\" component={ItemEdit} exact={true}/>\n          </ItemProvider>\n          <Route exact path=\"/\" render={() => <Redirect to=\"/items\"/>}/>\n        </AuthProvider>\n      </IonRouterOutlet>\n      <IonTabBar slot=\"bottom\">\n          <IonTabButton tab=\"home\" href=\"/items\">\n            <IonIcon icon={home} />\n          </IonTabButton>\n          <IonTabButton tab=\"search\" href=\"/search\">\n            <IonIcon icon={search} />\n          </IonTabButton>\n        </IonTabBar>\n      </IonTabs>\n    </IonReactRouter>\n  </IonApp>\n);\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","var map = {\n\t\"./ion-action-sheet.entry.js\": [\n\t\t112,\n\t\t5\n\t],\n\t\"./ion-alert.entry.js\": [\n\t\t113,\n\t\t6\n\t],\n\t\"./ion-app_8.entry.js\": [\n\t\t114,\n\t\t7\n\t],\n\t\"./ion-avatar_3.entry.js\": [\n\t\t115,\n\t\t18\n\t],\n\t\"./ion-back-button.entry.js\": [\n\t\t116,\n\t\t19\n\t],\n\t\"./ion-backdrop.entry.js\": [\n\t\t117,\n\t\t43\n\t],\n\t\"./ion-button_2.entry.js\": [\n\t\t118,\n\t\t20\n\t],\n\t\"./ion-card_5.entry.js\": [\n\t\t119,\n\t\t21\n\t],\n\t\"./ion-checkbox.entry.js\": [\n\t\t120,\n\t\t22\n\t],\n\t\"./ion-chip.entry.js\": [\n\t\t121,\n\t\t23\n\t],\n\t\"./ion-col_3.entry.js\": [\n\t\t122,\n\t\t44\n\t],\n\t\"./ion-datetime_3.entry.js\": [\n\t\t123,\n\t\t10\n\t],\n\t\"./ion-fab_3.entry.js\": [\n\t\t124,\n\t\t24\n\t],\n\t\"./ion-img.entry.js\": [\n\t\t125,\n\t\t45\n\t],\n\t\"./ion-infinite-scroll_2.entry.js\": [\n\t\t126,\n\t\t46\n\t],\n\t\"./ion-input.entry.js\": [\n\t\t127,\n\t\t25\n\t],\n\t\"./ion-item-option_3.entry.js\": [\n\t\t128,\n\t\t26\n\t],\n\t\"./ion-item_8.entry.js\": [\n\t\t129,\n\t\t27\n\t],\n\t\"./ion-loading.entry.js\": [\n\t\t130,\n\t\t28\n\t],\n\t\"./ion-menu_3.entry.js\": [\n\t\t131,\n\t\t29\n\t],\n\t\"./ion-modal.entry.js\": [\n\t\t132,\n\t\t8\n\t],\n\t\"./ion-nav_2.entry.js\": [\n\t\t133,\n\t\t15\n\t],\n\t\"./ion-popover.entry.js\": [\n\t\t134,\n\t\t9\n\t],\n\t\"./ion-progress-bar.entry.js\": [\n\t\t135,\n\t\t30\n\t],\n\t\"./ion-radio_2.entry.js\": [\n\t\t136,\n\t\t31\n\t],\n\t\"./ion-range.entry.js\": [\n\t\t137,\n\t\t32\n\t],\n\t\"./ion-refresher_2.entry.js\": [\n\t\t138,\n\t\t11\n\t],\n\t\"./ion-reorder_2.entry.js\": [\n\t\t139,\n\t\t17\n\t],\n\t\"./ion-ripple-effect.entry.js\": [\n\t\t140,\n\t\t47\n\t],\n\t\"./ion-route_4.entry.js\": [\n\t\t141,\n\t\t33\n\t],\n\t\"./ion-searchbar.entry.js\": [\n\t\t142,\n\t\t34\n\t],\n\t\"./ion-segment_2.entry.js\": [\n\t\t143,\n\t\t35\n\t],\n\t\"./ion-select_3.entry.js\": [\n\t\t144,\n\t\t36\n\t],\n\t\"./ion-slide_2.entry.js\": [\n\t\t145,\n\t\t48\n\t],\n\t\"./ion-spinner.entry.js\": [\n\t\t146,\n\t\t13\n\t],\n\t\"./ion-split-pane.entry.js\": [\n\t\t147,\n\t\t49\n\t],\n\t\"./ion-tab-bar_2.entry.js\": [\n\t\t148,\n\t\t37\n\t],\n\t\"./ion-tab_2.entry.js\": [\n\t\t149,\n\t\t16\n\t],\n\t\"./ion-text.entry.js\": [\n\t\t150,\n\t\t38\n\t],\n\t\"./ion-textarea.entry.js\": [\n\t\t151,\n\t\t39\n\t],\n\t\"./ion-toast.entry.js\": [\n\t\t152,\n\t\t40\n\t],\n\t\"./ion-toggle.entry.js\": [\n\t\t153,\n\t\t12\n\t],\n\t\"./ion-virtual-scroll.entry.js\": [\n\t\t154,\n\t\t50\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 76;\nmodule.exports = webpackAsyncContext;","var map = {\n\t\"./ion-icon.entry.js\": [\n\t\t158,\n\t\t57\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 78;\nmodule.exports = webpackAsyncContext;"],"sourceRoot":""}